---
title: "ECON4408 Problem Set - RMarkdown"
author: "Gregorios Raymond"
date: "21 February 2022"
output:
  html_document: default
  word_document: default
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## R Markdown

include = FALSE prevents code and results from appearing in the finished file. R Markdown still runs the code in the chunk, and the results can be used by other chunks.
echo = FALSE prevents code, but not the results from appearing in the finished file. This is a useful way to embed figures.
message = FALSE prevents messages that are generated by code from appearing in the finished file.
warning = FALSE prevents warnings that are generated by code from appearing in the finished.
fig.cap = "..." adds a caption to graphical results.

```{r, message=FALSE, warning=FALSE}
library(tidyverse)
library(haven)
library(stargazer)
library(magrittr)
```

# Part 1 - World Bank Development Report Data
## Q1. What are the mean and standard deviation of GDP per capita and infant mortality across countries? Compare the average male illiteracy rate to the female illiteracy rate. Why might they be different?

```{r}
wbdr <- read_dta("wbdr.dta")
wbdr <- wbdr[-c(198), ] # remove 'World'
```

*wbdrNA* is the  dataset after I removed missing values in 'ppp_gdp' variable
```{r}
wbdrNA <- wbdr
wbdrNA <- complete.cases(wbdr$ppp_gdp)
wbdrNA <- wbdr[wbdrNA, ]
```

```{r}
mean(wbdrNA$ppp_gdp)
sd(wbdrNA$ppp_gdp)
```
*wbdrNA2* is the  dataset after I removed missing values in 'infant_mort' variable
```{r}
wbdrNA2 <- wbdr
wbdrNA2 <- complete.cases(wbdr$infant_mort)
wbdrNA2 <- wbdr[wbdrNA2, ]
```

```{r}
mean(wbdrNA2$infant_mort)
sd(wbdrNA2$infant_mort)
```
NB: the mean and stadandard deviation of PPP GDP is interpreted in dollar terms; i.e, mean of PPP GDP is $12404.46. For infant mortality rate, it is interpreted as "per 1000 live births" (i.e., mean of infant mortality is 35.63 per 1000 live births).

```{r}
mean(wbdr$fem_lit, na.rm = TRUE)
mean(wbdr$male_lit, na.rm = TRUE)
```
The average illiteracy rate for **female** is  22.772 percent (77.228 - 100).
The average illiteracy rate for **male** is 14.418 percent (85.582 - 100).

The difference in male and female illiteracy rates on average may be attributed to parents being more inclined to provide education for their male children as they believe that male is more likely to provide higher returns to education than female. Since we are looking at the average rate, it is likely that the female illiteracy rate is biased upward due to the higher female literacy rate in rich countries.

For a summary of the variables:
```{r}
stargazer(as.data.frame(wbdr), type="text")
```
## Q2. Restrict your data set to countries for which we have GDP per capita. What are the mean, minimum, and maximum illiteracy rate, and infant mortality rate among the 50 richest countries? Among the 50 poorest countries? What does this tell you about the relationship between income and illiteracy, and income and mortality?

Back to using *wbdrNA* dataset.
But now I will introduce 2 new dataset, *wbdrNAasc* and *wbdrNAdesc*, where I arrange wbdrNA into ascending and descending order, respectively.

```{r}
wbdrNAasc <- arrange(wbdrNA, ppp_gdp)
wbdrNAdesc <- arrange(wbdrNA, desc(ppp_gdp))
```

I will also use `head()` function to look for the first 50 observations in *wbdrNAasc* and *wbdrNAdesc* to figure out the 50 poorest and 50 richest countries.

```{r}
wbdrNAasc <- head(wbdrNAasc, 50) # 50 poorest
wbdrNAdesc <- head(wbdrNAdesc, 50) # 50 richest
```

50 richest countries:
```{r}
stargazer(as.data.frame(wbdrNAdesc), keep = c(6, 7), median = TRUE, type="text")
```
50 poorest countries:
```{r}
stargazer(as.data.frame(wbdrNAasc), keep = c(6, 7), median = TRUE, type="text")
```
NB: For infant mortality rate, the values are interpreted as "per 1000 live births" (i.e., the mean of infant mortality rate in the 50 richest countries is is 8.52 per 1000 live births). Similarly, for total illiteracy rate, the values are interpreted as "of population age ≥ 15 years old" (i.e., the mean of total illiteracy rate in the 50 richest countries is 5.2 % of population age ≥ 15 years old)

There is a strong negative correlation between income and illiteracy rates and income and infant mortality rates. The 50 richest countries have much lower average illiteracy and infant mortality rate relative to the 50 poorest. The maximum infant mortality rate in the 50 richest, however, shows 123.6 per 1000 live births. This information may reflect the unequal income distribution in Equatorial Guinea. Interestingly, the illiteracy rate in 5 of the 50 poorest countries is below 15% of the total population age ≥ 15 years old. One possible explanation is that these countries either are modern welfare states or having received international aid to alleviate inequality.

## Q3. Now, find the median GDP per capita. How is it different from the mean GDP per capita from part (a)? Why might the mean and median be different? What information can we infer about the income distribution (inequality) from this?

```{r}
stargazer(as.data.frame(wbdrNA), median = TRUE, keep = c(5), type="text")
```
The median of PPP GDP is \$6,821.15 while the mean is \$12,404.46.

The mean of PPP GDP is much higher than the median. The difference may reflect the skewed distribution of GDP. This information can infer high cross-country income inequality. The value of mean GDP is higher than the median due to high-income countries in the distribution (right skewed). 

The right-skewed distribution can be shown in a histogram:
```{r}
hist(wbdrNA$ppp_gdp, xlab = "GDP per capita, PPP 2005", main = "Distribution of Cross-Country Income")
abline(v = rep(median(wbdrNA$ppp_gdp)), col = "red", )
abline(v = rep(mean(wbdrNA$ppp_gdp)), col = "blue")
```

The $\color{red}{\text{red}}$ line shows the median value, while the $\color{blue}{\text{blue}}$ line represents the mean.

Using the mean value of GDP would not inform the correct information about average income across countries since the data is skewed. The median value would more accurately represent the income of most of the countries in this dataset.

# Return to unrestricted wbdr dataset

## Q4. Regress the illiteracy rate on per capita GDP. Report the coefficient on per capita GDP and its standard error; what do they tell you? Is the sign of the coefficient what you expected? Explain briefly. What is the t-statistic for this coefficient, and what does it tell you? Interpret the 95% confidence interval.

```{r}
wbdr$tot_illit <- 100 - wbdr$tot_lit # create a variable for total illiteracy rate
model1_2 <- lm(tot_illit ~ ppp_gdp, wbdr)
stargazer(model1_2, type = "text", omit = c(2), omit.stat = c("adj.rsq", "ser"), covariate.labels = c("GDP PPP"), dep.var.labels = c("Illiteracy Rate"), add.lines = list(c("t-stat", "-5.535"), (c("95% Confidence Interval", "(-0.0009575, -0.0004533)"))))
```

An increase in GDP per capita by \$1000 is associated with a reduction in illiteracy rates by 0.7054 percentage points. The sign of the coefficient is as expected since higher GDP per capita is reflected upon more income to afford schooling/education, and therefore an increased inability to read and write.

The t-statistic is -5.53, which is higher than the t-critical values of 1.65 (10% significance), 1.96 (5% significance), 2.57 (1% significance). Therefore, we can reject the null hypothesis that the coefficient of GDP per capita is not statistically significantly different from 0.

The 95% confidence interval is a range of values (i.e., -0.0009575 to -0.0004533) that we can be 95% confident contains the true mean of the population when the experiment is conducted infinite times.

The 95% confidence interval can also be interpreted as a lower and upper bound of the GDP per capita coefficient estimates. In the lower (upper) bound estimate, a \$1000 increase in GDP per capita is associated with a reduction in illiteracy rate by 0.4533 (0.9575) percentage points.

## Q5. Regress the infant mortality rate on GDP per capita. Is the coefficient on per capita GDP significantly different from zero? How do you know? Interpret the coefficient in terms of a $1000 difference in per capita GDP.
```{r}
model2 <- lm(infant_mort ~ ppp_gdp, wbdr)
stargazer(model2, type="text",omit = c(2), omit.stat = c("adj.rsq", "ser"), covariate.labels = c("GDP PPP"), dep.var.labels = c("Infant Mortality Rate"), add.lines = list(c("t-stat", "-8.888")))
```

The GDP per capita coefficient is statistically significantly different from zero. This can be shown from the t-statistic (|-8.92| > 1.65; 1.96; 2.57).

The coefficient is -0.0013651, therefore an increase in GDP per capita of \$1000 is associated with a 1.37 decrease in infant mortality (per 1000 live birth).

## Q6. Regress the infant mortality rate on the illiteracy rate. Graph a scatter plot of the data as well as the regression line.

```{r}
model3_2 <- lm(infant_mort ~ tot_illit, wbdr)
stargazer(model3_2, type = "text", omit = c(2), omit.stat = c("adj.rsq", "ser"), covariate.labels = c("Illiteracy Rate"), dep.var.labels = c("Infant Mortality Rate"))
``` 
```{r, warning = FALSE, message = FALSE}
ggplot(data = wbdr, mapping = aes(x = tot_illit, y = infant_mort)) +
  theme_bw() + 
  geom_point() +
  geom_smooth(method = "lm", se = FALSE,) + 
  xlab('Illiteracy Rate') +
  ylab('Infant Mortality Rate') +
  ggtitle('Scatter Plot: Illiteracy on Infant Mortality') +
  theme(plot.title = element_text(hjust = 0.5))
```

## Q7. Using the results from above, what can we say about the causal relationship between illiteracy and income (GDP)?

It is difficult to infer a causal relationship between GDP and illiteracy rates due to endogeneity concerns at play. For example, the case for reverse causality is possible, where countries with lower illiteracy rates are less able to achieve a higher income level. However, from the plot, we can see that, on average, countries with high illiteracy rates also face high infant mortality rates, this informs the common trends in developing countries.

Omitted variables such as (economic and political) institutions in each country can affect both illiteracy rate and income. Political actors play a major role in policy implementation. Extractive political institutions may prefer to retain dominance by not providing essential public goods such as free reading materials. Similarly, authoritarian political regime can halt foreign investment (e.g., due to the high risk of expropriation), hence GDP is negatively impacted by extractive political institution.
